<nav class="navbar navbar-inverse navbar-static-top" >
  <div class="container mynavbar">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">KFeedApp</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><%= link_to "All Feedings", feedings_path %></li>

      <% if signed_in? %>
        <li class="dropdown">
        <% if current_user.name.blank? == false && current_user.profile_pic.blank? == false %>
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Hello <%= current_user.name%>  <%= image_tag current_user.profile_pic.url(:minithumb).to_s, class: "img-circle" %> <span class="caret"></span></a>
          <% elsif current_user.name.blank? == false && current_user.profile_pic.blank? %>
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Hello <%= current_user.name%> <span class="caret"></span></a>
          <% else %>
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Hello <%= current_user.email %> <span class="caret"></span></a>
          <% end %>
          <ul class="dropdown-menu">
            <li><%= link_to "My Profile", user_path(current_user.id) %></li>
            <li><%= link_to "Feeding Events Posted", user_feedings_path(current_user.id) %></li>
            <li><%= link_to "Feeding Events Joined", user_feeders_path(current_user.id) %></li>
            <li><%= link_to "Sign Out", destroy_user_session_path, method: :delete %></li>
           <!--  <li role="separator" class="divider"></li>
            <li class="dropdown-header">Unpaid Events</li>
            <% @joined_events = current_user.feeders %>
            <% @not_free_feedings = [] %>
                    <% @joined_events.each do |joined| %>
                    <% if joined.feeding.price != nil || joined.feeding.price != 0 %>
                    <% @not_free_feedings << joined %>
                    <% end %>
                    <% end %>
                    <% @unpaid_joins = [] %>
                    <% @not_free_feedings.each do |joined| %>
                    <% if joined.payments.where(status: :authorized).blank? %>
                    <% @unpaid_joins << joined %>
                    <% end %>
                    <% end %>
             
                    <% if @unpaid_joins.empty? %>
                    <li style="text-align: center"> None </li>
                    <% else %>
                    <% @unpaid_joins.each_with_index do |joined, index| %> 
                    <li><%= link_to "#{index+1}. Reservation for : #{joined.feeding.name} | RM #{joined.feeding.price.to_s}", feeding_feeder_path(joined.feeding.id, joined.id) %></li>
                    <%end%>
                    <%end%> -->
      
          </ul>
        </li>
      </ul>

      <% else %>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get Started <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><%= link_to "Sign Up", new_user_registration_path %></li>
            <li><%= link_to "Sign In", new_user_session_path %></li>
     <!--        <li role="separator" class="divider"></li>
            <li class="dropdown-header">Insert Link1</li>
            <li><a href="#">Insert Link2</a></li>
          </ul>
        </li>
      <% end %>

      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>

<script>
$(document).ready(function(){
    $(".dropdown-toggle").dropdown();
});
</script>